# 面试文档

## redis

### [什么是redis](https://xiaolincoding.com/redis/base/redis_interview.html#%E4%BB%80%E4%B9%88%E6%98%AF-redis)

Redis 是一种基于内存的数据库，对数据的读写操作都是在内存中完成，因此读写速度非常快，常用于缓存，消息队列、分布式锁等场景。

### 有关于线程问题

redis程序并不是单线程的，存在多个线程共存，但是「接收客户端请求-&gt;解析请求 -&gt;进行数据读写等操作-&gt;发送数据给客户端」这个过程是由一个线程（主线程）来完成的，所以我们常说redis是单线程的。

采取单线程快的原因：

- Redis 的大部分操作**都在内存中完成**，并且采用了高效的数据结构，所以限制速度的因素变成了 **机器的内存或者网络带宽**
- Redis 采用单线程模型可以**避免了多线程之间的竞争**，省去了多线程切换带来的时间和性能上的开销，而且也不会导致死锁问题

### Redis 6.0 之后为什么引入了多线程？

这是因为随着网络硬件的性能提升，Redis 的性能瓶颈有时会出现在网络 I/O 的处理上，所以为了提高网络 I/O 的并行度，Redis 6.0 对于网络 I/O 采用多线程来处理。其他的保持不变。

## 项目

### 农产品追溯项目

#### redis的使用

- **用户认证**：通过校验用户和密码，系统生成标识符Token或 Session ID，这个标识符将在后续的请求中用于识别用户的身份。将生成的 Token 或 Session ID 发送给客户端，通常通过 HTTP 响应头中的 `Set-Cookie` 字段或者作为 JSON 数据的一部分发送给前端。客户端（浏览器或其他客户端）会保存这个 Token，并在后续的请求中将其包含在内。当后期客户端发来请求时，检验Token是否存在于redis中
- **状态跟踪**：

​	Redis 可以用来存储一些轻量级的状态信息。

​		**在线状态**：记录用户是否在线。

​		**任务状态**：记录后台任务的状态，如上传进度。

​		String简单地用，复杂的用Hash类型

- **对象缓存**：缓存数据库查询结果，避免重复查询，减少数据库的压力
- **计数器**：记录某个事件发生的次数，如网站访问量。

- **统计数据**：记录一段时间内的数据汇总，如一天内的用户活跃度。

#### QrCodeUtils 工具类

利用客户端传来id信息，前往数据库中获取相关信息，将信息总和起来放入一个变量中，利用QrCodeUtils 生成二维码（字节数组格式）传到前端，前端再将其转化成二维码展示。

#### 日志功能

利用自动注解和aop切面实现：

​	自动注解：用于标记需要记录操作日志的方法或类

​	切面类：

​	切面点：定义我们所要的操作，这里的作用是记录操作的行为，将日志存储

#### 难点

##### 信息的统一性问题

当数据更新的时原有二维码将会失去效力，而又无法获得最新的数据。因为我们知道当二维码确定时其内部的信息也就是确定的，也就没法使数据更新。

**解决方法**：生成一个指向特定 URL 的二维码，将使用者引导到一个网页，网页从后端服务器中来获取数据展示。

##### [操作日志的实现](https://zhuanlan.zhihu.com/p/336941515)

前期没有对切面学习透彻，日志准备使用每次用了一个操作写一个单独的语句指向数据库，代码臃肿，有的还忘记写此部分。

解决方法：使用自定义注解+aop切面编程解决

##### 数据库设计



#### 从项目中获得的成长

1. 加强了一些Java进阶知识的了解和运用，比如aop和注解，让我更加熟练和理解一些其中的知识
2. 让我开始去考虑sql优化，减少多余的sql查询，提高sql速度
3. 加强了数据库的设计能力

### 刷题系统

#### 差异化菜单开发

利用角色间不同的权限设置开发差异化菜单，以实现限制不同角色操作。利用三个表（用户表、角色表和权限表）

#### 批量导入功能

解析文件是这个功能的重难点，文件传输过来以后首先检查是否满足格式（前期可以获取模板，直接在模板上修改添加数据），满足格式的开始获取逐行数据，先进行数据校验是否已经存在（字段校验），不存在就处理，添加数据

#### 反 aip 端点访问

利用权限编码与 aop 实现权限校验，防止他人直接访问 API 端点来获取资源与数据。枚举权限编码，利用注解和aop进行安全校验
